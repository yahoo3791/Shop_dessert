"use strict";(self["webpackChunkeshop"]=self["webpackChunkeshop"]||[]).push([[163],{163:function(e,t,o){o.r(t),o.d(t,{default:function(){return ce}});var n=o(6252),s=o(3577);const a={class:"container pt-utility",style:{height:"100vh"}},l={class:"text-end"},i={class:"row"},d={key:0,class:"col-12"},p=(0,n._)("h2",{class:"text-black text-center",style:{padding:"30vh 0"}},"尚未新增優惠卷。 ",-1),u=[p],c={key:1,class:"col-12"},m={class:"table mt-4"},r=(0,n._)("thead",null,[(0,n._)("tr",{class:"font-medium tracking-wider"},[(0,n._)("th",null,"名稱"),(0,n._)("th",{class:"d-none d-md-table-cell"},"折扣百分比"),(0,n._)("th",null,"到期日"),(0,n._)("th",{class:"d-none d-md-table-cell"},"是否啟用"),(0,n._)("th",null,"編輯")])],-1),h={class:"d-none d-md-table-cell"},b={class:"d-none d-md-table-cell"},_={key:0,class:"text-success"},C={key:1,class:"text-muted"},v={class:"p-0"},g={class:"btn-group"},y=["onClick"],w=["onClick"];function f(e,t,o,p,f,x){const k=(0,n.up)("Loading"),D=(0,n.up)("couponModal"),L=(0,n.up)("deleteModal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(k,{active:f.isLoading},null,8,["active"]),(0,n._)("div",null,[(0,n._)("div",a,[(0,n._)("div",l,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t[0]||(t[0]=e=>x.openCoupon(!0))}," 新增優惠卷 ")]),(0,n._)("div",i,[0===f.getCoupons.length?((0,n.wg)(),(0,n.iD)("div",d,u)):((0,n.wg)(),(0,n.iD)("div",c,[(0,n._)("table",m,[r,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(f.getCoupons,(t=>((0,n.wg)(),(0,n.iD)("tbody",{key:t.id},[(0,n._)("tr",null,[(0,n._)("td",null,(0,s.zw)(t.title),1),(0,n._)("td",h,(0,s.zw)(t.percent),1),(0,n._)("td",null,(0,s.zw)(e.$filters.date(t.due_date)),1),(0,n._)("td",b,[1===t.is_enabled?((0,n.wg)(),(0,n.iD)("span",_," 啟用 ")):((0,n.wg)(),(0,n.iD)("span",C," 未起用 "))]),(0,n._)("td",v,[(0,n._)("div",g,[(0,n._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>x.openCoupon(!1,t)}," 編輯 ",8,y),(0,n._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>x.openDeleteModal(t)}," 刪除 ",8,w)])])])])))),128))])]))])])]),(0,n.Wm)(D,{ref:"couponModal",coupon:f.tempCoupon,onSaveCoupon:x.couponData},null,8,["coupon","onSaveCoupon"]),(0,n.Wm)(L,{ref:"deleteModal","delete-item":f.deleteCoupon,onDeleteCoupon:x.deleteItem},null,8,["delete-item","onDeleteCoupon"])],64)}var x=o(9963);const k={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},D={class:"modal-dialog"},L={class:"modal-content text-black"},M=(0,n._)("div",{class:"modal-header"},[(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠卷 "),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),U={class:"modal-body"},$={class:"coupon_title mb-3"},E={for:"title"},T={class:"coupon_isEnabled mb-3"},B={for:"is_enabled"},I={class:"coupon_percent mb-3"},V={for:"percent"},Z={class:"coupon_dueDate mb-3"},z={for:"due_date"},S={class:"coupon_code mb-3"},H={for:"code"},N={class:"modal-footer"},O=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉 ",-1);function P(e,t,o,s,a,l){return(0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("div",D,[(0,n._)("div",L,[M,(0,n._)("div",U,[(0,n._)("div",$,[(0,n._)("label",E,[(0,n.Uk)("優惠卷名稱 "),(0,n.wy)((0,n._)("input",{type:"text",name:"title",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>a.tempCoupon.title=e)},null,512),[[x.nr,a.tempCoupon.title]])])]),(0,n._)("div",T,[(0,n._)("label",B,[(0,n.Uk)("是否啟用 "),(0,n.wy)((0,n._)("input",{type:"checkbox",name:"is_enabled",id:"is_enabled","onUpdate:modelValue":t[1]||(t[1]=e=>a.tempCoupon.is_enabled=e)},null,512),[[x.e8,a.tempCoupon.is_enabled]])])]),(0,n._)("div",I,[(0,n._)("label",V,[(0,n.Uk)("折扣百分比 "),(0,n.wy)((0,n._)("input",{type:"number",name:"percent",id:"percent","onUpdate:modelValue":t[2]||(t[2]=e=>a.tempCoupon.percent=e)},null,512),[[x.nr,a.tempCoupon.percent]])])]),(0,n._)("div",Z,[(0,n._)("label",z,[(0,n.Uk)("到期日 "),(0,n.wy)((0,n._)("input",{type:"date",name:"due_date",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=e=>a.tempCoupon.due_date=e)},null,512),[[x.nr,a.tempCoupon.due_date]])])]),(0,n._)("div",S,[(0,n._)("label",H,[(0,n.Uk)("折扣代碼 "),(0,n.wy)((0,n._)("input",{type:"text",name:"code",id:"code","onUpdate:modelValue":t[4]||(t[4]=e=>a.tempCoupon.code=e)},null,512),[[x.nr,a.tempCoupon.code]])])])]),(0,n._)("div",N,[O,(0,n._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>l.saveCoupon&&l.saveCoupon(...e))},"儲存 ")])])])],512)}var W=o(1339),Y={data(){return{modal:{},tempCoupon:{}}},props:["coupon"],mixins:[W.Z],methods:{saveCoupon(){this.$emit("saveCoupon",this.tempCoupon),this.modal.hide()}},watch:{coupon(){this.tempCoupon=this.coupon}}},j=o(3744);const K=(0,j.Z)(Y,[["render",P]]);var q=K;const A={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},F={class:"modal-dialog"},G={class:"modal-content text-black"},J=(0,n._)("div",{class:"modal-header"},[(0,n._)("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除警告"),(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},R={class:"text-red"},X=(0,n._)("p",null,"刪除後無法復原",-1),ee={class:"modal-footer"},te=(0,n._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function oe(e,t,o,a,l,i){return(0,n.wg)(),(0,n.iD)("div",A,[(0,n._)("div",F,[(0,n._)("div",G,[J,(0,n._)("div",Q,[(0,n._)("p",null,[(0,n.Uk)("確定要刪除"),(0,n._)("span",R,(0,s.zw)(o.deleteItem.code),1),(0,n.Uk)("優惠碼")]),X]),(0,n._)("div",ee,[te,(0,n._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>i.deleteCoupon&&i.deleteCoupon(...e))},"確定刪除")])])])],512)}var ne={data(){return{modal:{}}},mixins:[W.Z],mounted(){},methods:{deleteCoupon(){this.$emit("deleteCoupon",this.deleteItem.id)}},props:["deleteItem"]};const se=(0,j.Z)(ne,[["render",oe]]);var ae=se,le=o(7398),ie=o.n(le);const de=o(6455);var pe={data(){return{tempCoupon:{},pagination:{},getCoupons:{},deleteCoupon:{},isLoading:!1,isNew:!1}},inject:["emitter"],methods:{openCoupon(e,t){this.$refs.couponModal.modalShow(),this.tempCoupon=!0===e?{}:{...t},this.isNew=e},couponData(e){this.tempCoupon=e,this.tempCoupon.due_date=new Date(this.tempCoupon.due_date).getTime()/1e3,!0===this.tempCoupon.is_enabled?this.tempCoupon.is_enabled=1:this.tempCoupon.is_enabled=0;let t="https://vue3-course-api.hexschool.io/api/dessertsweet/admin/coupon",o="post";!1===this.isNew&&(t=`https://vue3-course-api.hexschool.io/api/dessertsweet/admin/coupon/${this.tempCoupon.id}`,o="put"),this.isLoading=!0,this.axios[o](t,{data:this.tempCoupon}).then((()=>{this.isLoading=!1,this.updateData(),this.emitter.emit("push-message",{style:"success",title:"更新成功"})})).catch((()=>{const e=de.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",de.stopTimer),e.addEventListener("mouseleave",de.resumeTimer)}});e.fire({icon:"error",title:"連線異常"})}))},updateData(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/dessertsweet/admin/coupons?page=${e}`;this.axios.get(t).then((e=>{this.isLoading=!1,this.getCoupons=e.data.coupons,this.pagination=e.data.pagination})).catch((()=>{const e=de.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",de.stopTimer),e.addEventListener("mouseleave",de.resumeTimer)}});e.fire({icon:"error",title:"連線異常"})}))},openDeleteModal(e){this.$refs.deleteModal.modalShow(),this.deleteCoupon=e},deleteItem(e){this.$refs.deleteModal.modalHide(),this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/dessertsweet/admin/coupon/${e}`;this.isLoading=!1,this.axios.delete(t).then((()=>{this.updateData(),this.emitter.emit("push-message",{style:"success",title:"刪除成功"})})).catch((()=>{const e=de.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",de.stopTimer),e.addEventListener("mouseleave",de.resumeTimer)}});e.fire({icon:"error",title:"連線異常"})}))}},components:{couponModal:q,deleteModal:ae,Loading:ie()},mounted(){this.updateData()}};const ue=(0,j.Z)(pe,[["render",f]]);var ce=ue}}]);
//# sourceMappingURL=163.c48c883c.js.map